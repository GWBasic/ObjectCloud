{
   "Command": "Compile",
   "ThreadID": 123,
   "Data":
   {
      "Script": "foo.a = 123; function foo(a){return a + \"!!!\";} function bar() {} aaa(1,2,'3', function(){});",
      "ScriptID": 543
   }
}

{
   "Command": "LoadCompiled",
   "ThreadID": 123,
   "Data":
   {
"CompiledScript":["yv66vgADAC0AsgEAS2NvbS9vYmplY3RjbG91ZC9qYXZhc2NyaXB0L2dlbmVyYXRlZF80OTQ5Mzg5NjY0NTg3NTcyNzM4NDI4ODc0NTMxNzAxNzExNjE0OAcAAQEAJW9yZy9tb3ppbGxhL2phdmFzY3JpcHQvTmF0aXZlRnVuY3Rpb24HAAMBAAU8Y21kPgEAA19pZAEAAUkBAARfZGNwAQBNTGNvbS9vYmplY3RjbG91ZC9qYXZhc2NyaXB0L2dlbmVyYXRlZF80OTQ5Mzg5NjY0NTg3NTcyNzM4NDI4ODc0NTMxNzAxNzExNjE0ODsBAANfcmUBABNbTGphdmEvbGFuZy9PYmplY3Q7AQAGPGluaXQ+AQBHKExvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7TG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvQ29udGV4dDtJKVYBAAMoKVYMAAwADgoABAAPDAAGAAcJAAIAEQEAA19pMQEARihMb3JnL21vemlsbGEvamF2YXNjcmlwdC9Db250ZXh0O0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7KVYMABMAFAoAAgAVAQADX2kyDAAXABQKAAIAGAEAA19pMwwAGgAUCgACABsBAARDb2RlAQAdb3JnL21vemlsbGEvamF2YXNjcmlwdC9TY3JpcHQHAB4BAARtYWluAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgwADAAOCgACACIBADUoTG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvU2NyaXB0O1tMamF2YS9sYW5nL1N0cmluZzspVgwAIAAkAQArb3JnL21vemlsbGEvamF2YXNjcmlwdC9vcHRpbWl6ZXIvT3B0UnVudGltZQcAJgoAJwAlAQAEZXhlYwEAVyhMb3JnL21vemlsbGEvamF2YXNjcmlwdC9Db250ZXh0O0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7KUxqYXZhL2xhbmcvT2JqZWN0OwEABGNhbGwBAI0oTG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvQ29udGV4dDtMb3JnL21vemlsbGEvamF2YXNjcmlwdC9TY3JpcHRhYmxlO0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMACsALAoAAgAtAQAKaGFzVG9wQ2FsbAEAIyhMb3JnL21vemlsbGEvamF2YXNjcmlwdC9Db250ZXh0OylaDAAvADABACRvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdFJ1bnRpbWUHADIKADMAMQEACWRvVG9wQ2FsbAEArihMb3JnL21vemlsbGEvamF2YXNjcmlwdC9DYWxsYWJsZTtMb3JnL21vemlsbGEvamF2YXNjcmlwdC9Db250ZXh0O0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7TG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvU2NyaXB0YWJsZTtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwANQA2CgAzADcBAANfYzABANooTGNvbS9vYmplY3RjbG91ZC9qYXZhc2NyaXB0L2dlbmVyYXRlZF80OTQ5Mzg5NjY0NTg3NTcyNzM4NDI4ODc0NTMxNzAxNzExNjE0ODtMb3JnL21vemlsbGEvamF2YXNjcmlwdC9Db250ZXh0O0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7TG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvU2NyaXB0YWJsZTtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAOQA6CgACADsBAANfYzEMAD0AOgoAAgA+AQADX2MyDABAADoKAAIAQQEAA19jMwwAQwA6CgACAEQBABJnZXRMYW5ndWFnZVZlcnNpb24BAAMoKUkBAA9nZXRGdW5jdGlvbk5hbWUBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAAAgASgEAA2ZvbwgATAEAA2JhcggATgEADWdldFBhcmFtQ291bnQBABNnZXRQYXJhbUFuZFZhckNvdW50AQARZ2V0UGFyYW1PclZhck5hbWUBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAFhCABUAQAQZ2V0RW5jb2RlZFNvdXJjZQEAXMKHJwNmb29rJwFhWShTe1EBbAEnA2Zvb1YnAWFXVAEEJwFhFSkDISEhUQFVwqABbAEnA2JhclZXVAFVwqABJwNhYWFWKFMBWChTAlgpATNYbAJWV1QBVcKgV1EBCABXAQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwwAWQBaAQAQamF2YS9sYW5nL1N0cmluZwcAXAoAXQBbAQASZ2V0UGFyYW1PclZhckNvbnN0AQAEKEkpWgEACmluaXRTY3JpcHQBAJEoTG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvTmF0aXZlRnVuY3Rpb247TG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvU2NyaXB0YWJsZTtMb3JnL21vemlsbGEvamF2YXNjcmlwdC9Db250ZXh0O0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L1NjcmlwdGFibGU7WilWDABhAGIKADMAYwwADAANCgACAGUMAAgACQkAAgBnAQAMaW5pdEZ1bmN0aW9uAQBuKExvcmcvbW96aWxsYS9qYXZhc2NyaXB0L05hdGl2ZUZ1bmN0aW9uO0lMb3JnL21vemlsbGEvamF2YXNjcmlwdC9TY3JpcHRhYmxlO0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L0NvbnRleHQ7KVYMAGkAagoAJwBrAQAGZ2xvYmFsAQAjTG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvU2NyaXB0YWJsZTsBAAhpbnN0YW5jZQEAEkxqYXZhL2xhbmcvT2JqZWN0OwwAbwBwAQAgb3JnL21vemlsbGEvamF2YXNjcmlwdC9VbmRlZmluZWQHAHIJAHMAcQEABG5hbWUBAGkoTG9yZy9tb3ppbGxhL2phdmFzY3JpcHQvQ29udGV4dDtMb3JnL21vemlsbGEvamF2YXNjcmlwdC9TY3JpcHRhYmxlO0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsMAHUAdgoAMwB3AQADX2swAQATTGphdmEvbGFuZy9JbnRlZ2VyOwwAeQB6CQACAHsBAA1zZXRPYmplY3RQcm9wAQBqKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvT2JqZWN0O0xvcmcvbW96aWxsYS9qYXZhc2NyaXB0L0NvbnRleHQ7KUxqYXZhL2xhbmcvT2JqZWN0OwwAfQB+CgAzAH8BABBqYXZhL2xh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"],
      "ScriptID": 543
   }
}

{
   "Command": "EvalScope",
   "ThreadID": 456,
   "ScopeID": 123,
   "Data":
   {
      "Scripts": [543],
      "Functions":["aaa","bbb","ccc"]
   }
}
{
   "ScopeID":123,
   "Command":"CallCallback",
   "ThreadID":456,
   "Data":
   {
      "CallbackId":-1817622645,
      "Arguments":[]
   }
}
{
   "ScopeID":123,
   "Command":"RespondCallParentFunction",
   "ThreadID":456,
   "Data":
   {
      "Result":[1,2,3]
   }
}


{
   "Command": "Compile",
   "ThreadID": 123,
   "Data":
   {
      "Script": "null",
      "ScriptID": 8765
   }
}
{
   "Command": "EvalScope",
   "ThreadID": 456,
   "ScopeID": 123,
   "Data":
   {
      "Scripts": [8765]
   }
}



{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 8765,
   "Data":
   {
      "Scripts": ["null", "1", "function foo(){}", "{}"]
   }
}
{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 875,
   "Data":
   {
      "Scripts": ["null", "1", "function foo(){}", "{}"]
   }
}
{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 865,
   "Data":
   {
      "Scripts": ["null", "1", "function foo(){}", "{}"]
   }
}
{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 765,
   "Data":
   {
      "Scripts": ["null", "1", "function foo(){}", "{}"]
   }
}
{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 87,
   "Data":
   {
      "Scripts": ["null", "1", "function foo(){}", "{}"]
   }
}


{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 9876765,
   "Data":
   {
      "Scripts": [876856]
   }
}


{
   "Command": "EvalScope",
   "ThreadID": 654,
   "ScopeID": 8765,
   "Data":
   {
      "Scripts": ["throw 'gsfdgsgsdf'", "null", "1", "function foo(){}", "{}"]
   }
}


{
   "Command": "Compile",
   "ThreadID": 123,
   "Data":
   {
      "Script": "hehre e4tsets h6ehe",
      "ScriptID": 654653
   }
}


























------------------
Old test codes

{
   "Scripts": ["foo.a = 123; function foo(a){return a + \"!!!\";} function bar() {} aaa(1,2,'3', function(){});"],
   "Functions":["aaa","bbb","ccc"]
}
{
   "ScopeID":123,
   "Command":"CreateScope",
   "ThreadID":456,
   "Data": {}
}

{
   "ScopeID":123,
   "Command":"CallCallback",
   "ThreadID":456,
   "Data":
   {
      "CallbackId":1683844457,
      "Arguments":[]
   }
}

{
   "ScopeID":123,
   "Command":"RespondCallParentFunction",
   "ThreadID":456,
   "Data":
   {
      "Result":[1,2,3]
   }
}

{
   "ScopeID":123,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"foo",
      "Arguments":["gadsgdsa"]
   }
}

{
   "ScopeID":123,
   "Command":"EvalScope",
   "ThreadID":456,
   "Data":
   {
      "Script": "if (typeof CreateHttpRequest != 'function')   CreateHttpRequest = function()   {      var toReturn =      {         headers: {},         open: function(webMethod, url, asyncronous)         {            this.webMethod = webMethod;            this.url = url;            this.asyncronous = asyncronous;         },         setRequestHeader: function(name, value)         {                        this.headers[name] = value;         },         send: function(payload)         {            results = Shell(               this.webMethod,               this.url,               this.headers['Content-type'],               payload);            this.readyState = 4;            this.status = results.Status;            this.responseText = results.Content;            if (this.asyncronous)               this.onreadystatechange();         }      };      return toReturn;   };"
   }
}

{
   "ScopeID":123,
   "Command":"EvalScope",
   "ThreadID":456,
   "Data":
   {
      "ReturnFunctions":true,
      "Script": "function a() {aaa();}",
      "Functions":["aaa"]
   }
}

{
   "ScopeID":123,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"a",
      "Arguments":[]
   }
}

{
   "ScopeID":123,
   "Command":"RespondCallParentFunction",
   "ThreadID":456,
   "Data":
   {
      "Exception":{"Message":"afvafafaerf","ParentObjectId":123456}
   }
}


{
   "ScopeID":123,
   "Command":"EvalScope",
   "ThreadID":456,
   "Data":
   {
      "Script": "function b(a,b,c) {return a + ' ' + b + ' ' + c;}",
   }
}

{
   "ScopeID":123,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"b",
      "Arguments":[1,"fdsdfsa", {"apple":"fruit"}]
   }
}


{
   "ScopeID":123,
   "Command":"EvalScope",
   "ThreadID":456,
   "Data":
   {
      "Script": "function c(a) {return a;}",
   }
}

{
   "ScopeID":123,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"c",
      "Arguments":[{"apple":"fruit"}]
   }
}

{
   "ScopeID":123,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"c",
      "Arguments":[["apple","fruit",456,789]]
   }
}

{
   "ScopeID":123,
   "Command":"EvalScope",
   "ThreadID":456,
   "Data":
   {
      "ReturnFunctions":true,
      "Script": "var t = xxx(); t;",
      "Functions":["xxx"]
   }
}

{
   "ScopeID":123,
   "Command":"RespondCallParentFunction",
   "ThreadID":456,
   "Data":{"Result":null}
}






{
   "Scripts": ["var a = 0; function getA(){return a;} function setA(newA){a = newA;} function getB(){return b;} 123;"],
   "Functions":[]
}
{
   "ScopeID":1,
   "Command":"CreateScope",
   "ThreadID":456,
   "Data": {b:[0,1,2,3,4,5]}
}
{
   "ScopeID":2,
   "Command":"CreateScope",
   "ThreadID":456,
   "Data": {}
}
{
   "ScopeID":1,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"getB",
      "Arguments":[]
   }
}
{
   "ScopeID":2,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"getB",
      "Arguments":[]
   }
}

{
   "ScopeID":1,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"setA",
      "Arguments":[1]
   }
}
{
   "ScopeID":2,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"setA",
      "Arguments":[2]
   }
}

{
   "ScopeID":1,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"getA",
      "Arguments":[]
   }
}
{
   "ScopeID":2,
   "Command":"CallFunctionInScope",
   "ThreadID":456,
   "Data":
   {
      "FunctionName":"getA",
      "Arguments":[]
   }
}

{
   "Scripts": ["try{throw 'ooops'}catch(e){throw e;};"],
   "Functions":[]
}
{
   "ScopeID":1,
   "Command":"CreateScope",
   "ThreadID":456,
   "Data": {b:[0,1,2,3,4,5]}
}

{
   "Scripts": ["testError(\"err\");"],
   "Functions":[]
}
{
   "ScopeID":1,
   "Command":"CreateScope",
   "ThreadID":456,
   "Data": {}
}
{
   "ScopeID":1,
   "Command":"dne",
   "ThreadID":456,
   "Data": {}
}

