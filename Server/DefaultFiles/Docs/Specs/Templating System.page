{"Contents": "\n<p>This document describes the design for ObjectCloud's templating system. &nbsp;As of this writing, ObjectCloud's templating system is unimplemented. &nbsp;The templating system constructs XML documents from many components and default header / footer documents stored in the server. &nbsp;It resolves Javascript dependancies among all components; transforms script, image, and CSS tags to use&nbsp;cacheable&nbsp;requests; uses a (yet-to-be-decided) jQuery templating system for further rendering of dynamic content; and provides ways for pages to manipulate the contents of the &lt;head&gt; tag. &nbsp;The templating system is designed to enable quick server-side rendering of documents with low CPU and RAM overhead, thus enabling ObjectCloud to handle higher loads and run on inexpensive hardware and VMs. &nbsp;Future versions of the templating system may support hybrid server/browser rendering of content by streaming data through The Comet Protocol to give an illusion of rapid response times. &nbsp;They may also support .Net plugins that provide further modifications of documents not anticipated in this design.</p><h1>Overview</h1><h2>Justification</h2><p>ObjectCloud currently contains a quickly-implemented templating system called the \"WebComponent\" system. &nbsp;An original design goal was that it would be somewhat compatible with PHP, although this goal was quickly forgotten. &nbsp;The WebComponent system has an inconsistant syntax, and has somewhat high CPU and RAM overhead because it essentially creates a new request for every component and script reference. &nbsp;The WebComponent system doesn't provide true templating, however, which means that data needs to be rendered in either server-side or in-browser Javascript. &nbsp;This further hinders performance. &nbsp;The final problem with the WebComponent templating system is that every page needs to be aware and include system headers and footers, and that pages don't have ways to manipulate such parts of the page.</p><p>The WebComponent system demonstrates the following good features that will be included in ObjectCloud's templating system:</p><p></p><ul><li>Ability to include server-side rendered components within a page.</li><li>Resolution of Javascript&nbsp;dependancies&nbsp;and avoidance of duplicate &lt;script&gt; tags.</li><li>Generation of URLs that support agressive caching and reload only when contents change.</li><li>Conditionally rendering content based on who the user is or what kind of permissions exist.</li><li>Ability to pass arguments to components.</li><li>Automatic minification of Javascript</li></ul>The WebComponent system has the following flaws that will not be included in ObjectCloud's templating system:<p></p><p></p><ul><li>Excessive reliance on emulating incoming web requests for each component and script.</li><li>Awkward, non-XML syntax.</li><li>Reliance on programming to render all data.</li><li>High CPU utilization and high RAM consumption.</li><li>Support of POST requests and cookies.</li><li>Requiring server-side or in-browser Javascript to \"execute\" a condition.</li><li>Explicit path requirements.</li><li>Requirement that component arguments be passed as url-encoded GET arguments.</li><li>No rollup and&nbsp;resolution&nbsp;of CSS file dependancies</li></ul><h2>Description</h2><p>The templating system is designed to fit into HTML5 where a valid XML document can be a valid HTML5 document. &nbsp;It uses a custom namespace that directs the templating engine to replace tags and alter attributes. &nbsp;The system uses convention for default headers and footers. &nbsp;Internally, ObjectCloud uses the System.Xml.XmlDocument for all manipulations, thus taking advantage of a battle-hardened and tested API for document generation.<br></p><p>The following general features are included:</p><h3>XML with Specific Namespace</h3><p>ObjectCloud's templating system is completely XML based. &nbsp;All tags and attributes are part of the \"objectcloud_templating\" namespace. &nbsp;The prefix \"oc\" is&nbsp;recommended. &nbsp;Using HTML5 as a default namespace is also&nbsp;recommended. &nbsp;Thus, a document will have tags like:</p><p></p><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p></p><pre>&lt;a href=\"...\"&gt;&lt;img src=\"...\" /&gt;&lt;/a&gt;</pre><pre>&lt;oc:component src=\"...\" /&gt;</pre><p></p></blockquote><p></p><h3>Component Support</h3><p>The &lt;oc:component&gt; tag will use a document named in the src attribute as a component. &nbsp;It will support&nbsp;declaring&nbsp;arguments in XML or pass-through of existing arguments. &nbsp;If src or url is omitted, then either the &lt;oc:component&gt; tag is removed, or if the document is being used as a header/footer for another document, the requested document is substituted in.</p><p>The &lt;oc:snipit&gt; tag is similar, except that it does not resolve GET parameters, only supports src, and expects an incomplete XML document.</p><p><span class=\"Apple-style-span\" style=\"font-size: 18px; font-weight: bold; \">Standard Header/Footer document</span><br></p><div>By default, all documents are wrapped in a standard header/footer. &nbsp;Documents that have a top-level &lt;html&gt; tag aren't wrapped in the standard header/footer, but can wrap other documents. &nbsp;Documents that have an &lt;oc:componentdef&gt; tag can control which header/footer is used to wrap themselves.</div><meta charset=\"utf-8\"><h3 style=\"font-size: 1.1em; font-weight: bold; \">Conditional Tags</h3><p>The &lt;oc:if&gt; tag is used to select a subset of tags to return. &nbsp;Within an &lt;oc:if&gt; tag are additional conditional tags. &nbsp;The first conditional that is met is kept, and all other conditionals are removed.</p><h3 style=\"font-size: 1.1em; font-weight: bold; \">Script&nbsp;Dependency&nbsp;Resolution</h3><p>There are two script tags that may be placed anywhere in a document. &nbsp;During resolution, these will be removed and &lt;script&gt; tags placed into the &lt;head&gt; tag. &nbsp;The generated &lt;script&gt; tags will be in order with duplicate removed.</p><p>&lt;oc:script src=\"...\" /&gt; declares that a document relies on a given script.</p><p>&lt;oc:open filename=\"...\" varname=\"... /&gt; assists in manipulating objects on the server. &nbsp;It will create a global object named varname that can make calls into the object specified in filename.</p><p>There is also a third script tag, &lt;oc:externalscript&gt;, that accomplishes the same goal as having a&nbsp;separate&nbsp;script to work with the component. &nbsp;When using the oc:externalscript tag, the tag is removed from the component and a &lt;script&gt; tag is placed into the &lt;head&gt; tag that loads the script externally. &nbsp;This shrinks the size of the resulting XHTML document and allows the browser to take advantage of caching.</p><h3>CSS&nbsp;Dependency&nbsp;Resolution</h3><p>Documents may place an &lt;oc:css src=\"...\" /&gt; anywhere; although it is&nbsp;recommended&nbsp;that these tags be placed at the top of a document. &nbsp;These will be removed, and a corresponding &lt;link&gt; tag placed in the header. &nbsp;ObjectCloud will prevent duplicates; meaning, many components can all have an &lt;oc:css src=\"/mycss.css\"/&gt; tag, but only one corresponding &lt;link&gt; tag will be generated.<br></p><h3>Header/Footer Manipulation from Components</h3><p>Components can insert items into the &lt;head&gt; tag by wrapping them in an &lt;oc:inserthead loc=\"<i>some number</i>\" /&gt;. &nbsp;Negative numbers are placed at the beginning of the head tag, and positive numbers are at the end. &nbsp;Lower numbers come before higher numbers; thus tags within an &lt;oc:loc=\"5\"&gt; will come before&nbsp;&lt;oc:loc=\"500\"&gt;.<br></p><meta charset=\"utf-8\"><p><i>TODO: &nbsp;&nbsp;&nbsp;Header/footer pages can leave room for these manipulations by placing &lt;oc:placehead loc=\"some number\" /&gt; in the &lt;head&gt; tag. &nbsp;If an &lt;oc:inserthead&gt; uses a loc that isn't specified in the &lt;head&gt; tag, ObjectCloud will attempt to find a reasonable place to put its contents within the &lt;head&gt; tag, with higher numbers placed towards the end of the &lt;head&gt; tag, and lower numbers placed towards the beginning. &nbsp;Negative numbers are placed in the beginning.</i></p><meta charset=\"utf-8\"><p>Footer manipulation is TBD but will most likely follow a similar pattern.</p><h3>JSON Template Support</h3><p>ObjectCloud supports templating data via JSON. &nbsp;Specifically, there is an &lt;oc:jsontemplate tag that takes two arguments, oc:src and oc:url. &nbsp;The request sent to oc:url must return JSON-encoded data, which is then processed by oc:src as if oc:src was a component. &nbsp;GET arguments must be explicitly passed as arguments.</p><h3>jQuery Template Support<br></h3><p><b>Note</b>: &nbsp;<i>The actual template syntax is TBD, but it's currently intended to be a popular jQuery templating syntax that can be supported on both the browser and the server.</i></p><p>Templates are supported through the &lt;oc:template ...&gt; tag. &nbsp;The contents of the tag will use a templating syntax that is TBD. &nbsp;The oc:template tag either has an oc:url or oc:src attribute. &nbsp;oc:url gives a complete url-encoded url that, without an http://, points to the same server, or with an http://, points to a remote server. &nbsp;oc:src gives a local filename without GET arguments. &nbsp;It is more efficient to use oc:src instead of oc:url. &nbsp;All attributes without a namespace are passed as GET arguments. &nbsp;<i>By adding an oc:get=\"passthrough\" attribute, current GET arguments are passed through. &nbsp;(Make default to be passthrough?)</i></p><p>The request must return either a JSON object, or an array of JSON objects. &nbsp;If an array is returned, then the template is applied to each object in order. &nbsp;If oc:pivot=\"true\" is present, then a single object is turned into an array of objects with two properties: &nbsp;\"name,\" and \"value.\"</p><p>TBD<br></p><h3>GET arguments</h3><p>GET arguments will be replaced prior to parsing XML. &nbsp;They use an [_ argname _] syntax, where argname is the XML-encoded argument name. &nbsp;By default, arguments are XML-encoded so that the user can't&nbsp;interfere&nbsp;with document parsing. &nbsp;This allows use of unicode argument names, argument names with &lt;, and user input with &lt;. &nbsp;At this time there is no way to un-encode user-supplied data.</p><p><span class=\"Apple-style-span\" style=\"font-size: 18px; font-weight: bold; \">Automatic &lt;img&gt;, &lt;script&gt;, and &lt;link&gt; tag manipulation for Caching support</span><br></p><p>Just before returning the completed document, ObjectCloud will look at all img, script, and link tags. &nbsp;It will modify all src attributes to use the BrowserCache GET argument, which allows the browser to cache the contents for a long time. &nbsp;This is a very fast way to cache images, scripts, and CSS, because the browser doesn't need to send an HTTP request to find out if the content changed; instead, the server informs the browser of changes by changing the contents of BrowserCache.</p><p>In these situations, ObjectCloud looks at the target URL. &nbsp;If the target URL doesn't have a ? in it, then ObjectCloud bases BrowserCache on the target file's date; but if there is an ?, then ObjectCloud simulates the request and computes an MD5. &nbsp;This can cause a performance overhead, so caching behavior can be controlled with the oc:browsercache attribute. &nbsp;The following values are supported:</p><p></p><ul><li><b>date</b>: &nbsp;Always use the target's date for BrowserCache.</li><li><b>md5</b>: &nbsp;Always use the target's MD5 for BrowserCache.</li><li><b>disable</b>: &nbsp;Do not use BrowserCache.</li></ul><p></p><h3>Content Manipulation</h3><p>The &lt;oc:trim&gt; tag allows for trimming its contents. &nbsp;This is useful for summarizing externally-loaded components. &nbsp;It has two optional parameters: &nbsp;maxlength is the maximum number of text characters, and maxtags is the&nbsp;maximum&nbsp;number of tags allowed within.</p><h3>Plugins</h3><p>Although not designed or implemented now, future versions can allow custom plugins that perform additional document manipulations via custom namespaces, tags, and attributes.</p><h2>Communication</h2><p>Errors and warnings generated by the template system will have a class=\"oc_template_warning\" attribute. &nbsp;This allows for styling and hiding template errors and warnings.<span class=\"Apple-tab-span\" style=\"white-space:pre\">\t</span></p><h2>Security</h2><p>All templating values from GET and JSON arguments are either placed into an attribute or text node. &nbsp;As a result, their contents are automatically escaped, making it very difficult for user input to inject tags or Javascript.</p><p>The &lt;oc:safeparse&gt; tag converts its text tags into xml. &nbsp;The \"safe\" tags are declared in /Shell/Security/safetags.json. Any tags not in the \"safe\" tags list are removed from the document. &nbsp;The&nbsp;oc:xmlparsemode attribute is supported by the &lt;oc:safeparse&gt; tag, see detailed documentation for &lt;oc:component&gt;.</p><meta charset=\"utf-8\"><p>The &lt;oc:safe&gt; tag behaves similar, but does not convert text to XML.</p><h1>Order of Operations</h1><p>TBD, but some thoughts:</p><pre>Replace GET arguments</pre><pre>While the current document doesn't declare that it doesn't use a header/footer</pre><p></p><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p></p><pre>Either encapsulate it in the standard header/footer or its declared header/footer</pre><p></p></blockquote><p></p><p>The above loop allows intermediate header/footer pairs. &nbsp;For example, a set of pages might have a set of common elements, and thus these can be condensed into an intermediate header/footer that sill fits within the system header/footer</p><pre>do</pre><p></p><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p></p><pre>While there are conditional and/or component tags</pre><p></p></blockquote><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p></p><pre>Evaluate all conditional tags and remove unused tags</pre><p></p></blockquote><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p></p><pre>Evaluate all component tags and load components</pre><p></p></blockquote></blockquote><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p></p><p>At this point all components are loaded and all conditions evaluated</p><p></p><p></p><pre>Collect all script dependancies, css dependancies, and header manipulations and create the appropriate tags in the header</pre><p></p><p></p><pre>Evaluate all template tags</pre><p></p></blockquote><p></p><pre>While there are conditional, component, script dependancies, header/footer manipulations, and/or template tags</pre><pre>Manipulate all &lt;img&gt;, &lt;script&gt;, and &lt;link&gt; tags to use ObjectCloud's caching features.</pre><pre>Resolve &lt;title&gt; tags.  The highest &lt;title&gt; tag is kept, and all other tags are removed.  If no title tag is found, but an &lt;oc:title&gt; tag is present, then remove the oc: namespace from the &lt;oc:title&gt; tag.</pre><pre>Remove all remaining &lt;oc:...&gt; tags.</pre><h1>Integration</h1><p>The /System/TemplateEngine object will perform all template rendering.</p><p>Header/footer files that have complete &lt;html&gt;, &lt;head&gt;, and &lt;body&gt; tags will have the .ochf extension. &nbsp;Components that are intended to be a complete document, except for the html tags, will have a .oc extension. &nbsp;Components that are intended for inclusion in other documents have a .occ extension. &nbsp;For all three extensions, the&nbsp;View action will be \"/System/TemplateEngine?Method=Evaluate&amp;filename=[Target]&amp;[Arguments]\" &nbsp;The Edit action will use Weco, a Javascript-based XHTML editor, or a Javascript-based XML editor.<br></p><p>TemplateEngine will return results with the \"text/xml\" MIME type, unless an error occurs.</p><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p><b>Note</b>: &nbsp;<i>Due to compatibility issues with FireFox, the resulting document is converted to \"html\" prior to returning. &nbsp;This basicly involves removing the &lt;?xml... tag and all namespaces from the &lt;html&gt; tag, and then inserting a &lt;!DOCTYPE html&gt; tag. &nbsp;The \"text/html\" MIME type is used specifically for Mozilla.</i></p></blockquote><meta charset=\"utf-8\"><meta charset=\"utf-8\"><p><span class=\"Apple-style-span\" style=\"font-size: 24px; font-weight: bold; \">Detail</span><br></p><div><h2>XML with Specific Namespace<br></h2><p>The resulting generated document that is delivered to the browser is a valid XHTML and HTML \"polygot\" document. &nbsp;The parent header/footer document must be both valid HTML and XHTML with &lt;oc:...&gt; tags, and all components are valid XML documents that use XHTML and &lt;oc:...&gt; tags. &nbsp;The \"polygot\" requirement is to allow ObjectCloud to use high-performance XML libraries. &nbsp;The resulting document is always delivered with the \"text/xml\" MIME type.</p><p><span class=\"Apple-style-span\" style=\"font-size: 20px; font-weight: bold; \">Header/Footer</span><br></p><p>A header/footer document is a valid HTML5 and XHTML document that also uses&nbsp;the \"objectcloud_templating\" namespace. &nbsp;An example is:</p></div><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><div><pre>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:oc=\"objectcloud_templating\"&gt;\n   &lt;head&gt;\n      &lt;oc:title&gt;Default Title&lt;/oc:title&gt;\n   &lt;/head&gt;\n   &lt;body&gt;\n      &lt;img src=\"Logo\" /&gt;\n      &lt;div&gt;Menu item 1 - Menu item 2 - Menu item 3&lt;/div&gt;\n      &lt;oc:component /&gt;\n   &lt;/body&gt;\n&lt;/html&gt;<br></pre></div></blockquote><div><p>Some things worth noting: &nbsp;The &lt;title&gt; tag is missing from &lt;head&gt;, it's assumed that another component will put it there. &nbsp;If no other component inserts a &lt;title&gt; tag, then the &lt;oc:title&gt; tag has its oc: namespace removed and is used as the default title. &nbsp;Also, the &lt;oc:component /&gt; tag will be replaced by the document that this header/footer document applies to.</p><h2>Component Support<br></h2><h3>Component Definitions</h3><p>Component documents start with the &lt;oc:componentdef&gt; tag and contain &lt;oc:...&gt; and html tags. &nbsp; For example:</p></div><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><div><pre>&lt;oc:componentdef xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:oc=\"objectcloud_templating\"&gt;\n   &lt;p&gt;Paragraph 1&lt;/p&gt;\n   &lt;p&gt;Paragraph 2&lt;/p&gt;\n   &lt;p&gt;Paragraph 3&lt;/p&gt;\n&lt;/oc:componentdef&gt;<br></pre></div></blockquote><div><p><i>It is possible to override the default header/footer in the &lt;oc:componentdef&gt; tag with the headerfooter attribute. &nbsp;If the specified header/footer is another component, it will then be wrapped by another header/footer. &nbsp;(Probably not implemented in first pass.)</i></p><p>GET arguments are supported in component definitions. &nbsp;By default,&nbsp;components&nbsp;get all the same GET arguments as the parent page, although the parent page can add, block, and override all GET arguments. &nbsp;In addition, there is a special GET argument, [_!_], which is&nbsp;guaranteed&nbsp;to be unique within a page. &nbsp;This allows components to have private elements, such as &lt;span id=\"myspan[_!_]\" ...</p><h3>Referencing Components</h3><p>Components are added to a document through the &lt;oc:component&gt; tag. &nbsp;There are two ways to handle &lt;oc:component&gt;</p><p></p><ul><li><b>Reference another component via oc:src</b>: &nbsp;Use the src attribute to give the relative or absolute path to another XML document that is a component. &nbsp;When ObjectCloud resolves this kind of component, it verifies READ permission to the file, loads it as XML, and inserts its results into the completed document. &nbsp;Components may refer to other components. &nbsp;In oc:src mode, by default, all GET parameters are passed through to the component, unless&nbsp;oc:getpassthough=\"false\" is included in the tag.</li><li><b>Simulate a GET request anywhere via oc:url</b>: &nbsp;When http:// isn't included, the request is simulated locally, and when http:// is included, the request can go to any HTTP server. &nbsp;The results are placed into the document as-is, although if the MIME type is \"text/xml,\" they will be parsed as XML and inserted as tags. &nbsp;GET parameters aren't passed through. &nbsp;Due to certificate complexities, https:// isn't supported.</li></ul>For both oc:src and oc:url, additional GET arguments can be added by adding additional attributes to the &lt;oc:component&gt; tag. &nbsp;Specifically, attributes without a namespace are passed through as GET arguments to the sub component. &nbsp;It's possible to explicitly pass GET arguments in a manner like myparam=\"[_myparam_]\".<p></p><p>If the &lt;oc:component&gt; tag has contents, by default, they will be omitted in the resulting document. &nbsp;In the event of a permission denied error for an &lt;oc:component&gt; tag with contents and the oc:src attribute, the templating engine will change the &lt;oc:component&gt; tag to a div. &nbsp;This is a lightweight way to handle permissions issues. &nbsp;When using oc:url, the results are always passed through, even if it's not a 2xx class result.<br></p><p>In some circumstances, it is desirable to use the &lt;oc:component&gt; tag with text that is, or might, be HTML instead of XML. &nbsp;This can be problematic because HTML, while similar to XML and XHTML, has some critical semantic differences that prevent some bits of HTML from loading as valid XML. &nbsp;The oc:xmlparsemode attribute controls this. &nbsp;It has three valid values:</p><p><ul><li><b>xml</b>: &nbsp;The default, contents are treated as valid XML. &nbsp;If the contents aren't valid XML, an error will occur.</li><li><b>html</b>: &nbsp;Contents are converted from HTML to XML before loading.</li><li><b>xmlthenhtml</b>: &nbsp;Contents are treated as valid XML, but if an error occurs, they are converted to HTML and attempted to be loaded again. &nbsp;Reliance on this setting is&nbsp;recommended&nbsp;only as a last-resort because the current algorithm can cause&nbsp;unnecessary&nbsp;overhead during runtime and developer debugging.</li></ul></p><p><span class=\"Apple-style-span\" style=\"font-size: 20px; font-weight: bold; \">Standard Header/Footer document</span><br></p><p>The default header and footer will be \"/DefaultTemplate/headerfooter.ochf\" &nbsp;By convention, default template images and CSS will go into \"/DefaultTemplate.\" &nbsp;This is to allow 3rd party default templates.</p><h2>Conditional Tags<br></h2><p>The &lt;oc:if&gt; tag allows a designer to conditionally include html in the displayed document. &nbsp;It can only contain known conditional tags (written below.) &nbsp;Each tag is evaluated in order, and the first tag where the condition is met is displayed. &nbsp;Only one tag within an &lt;oc:if&gt; is displayed, all others are discarded.</p><h2>Available Tags</h2><h3>Permissions</h3><p>All permission tags have a filename attribute. &nbsp;This is the file that permissions is checked on.<br></p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:canread</h4><p>True if the user can read the specified file.</p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:canwrite</h4><p>True if the user can write to the specified file.</p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:canadminister</h4><p>True if the user can administer the specified file.</p><p></p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:can</h4><p>In addition to filename, has an attribute called namedpermission. &nbsp;True if the user has the specified named permission to the file or is an administrator.</p><p></p><h4><span class=\"Apple-style-span\" style=\"font-size: 18px; \">User State</span><br></h4><p>The user state tags depend on who is logged in.</p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:isadministrator</h4><p>True if the user is an administrator.</p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:islocal</h4><p>True if the user is a local user, as opposed to OpenID.</p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:isloggedin</h4><p>True if the user is logged in, as opposed to an anonymous user.</p><h4 style=\"font-size: 1em; font-weight: bold; \">oc:isopenid</h4><p>True if the user is logged in through OpenID.</p><h4 style=\"font-size: 1em; font-weight: bold; \"><span class=\"Apple-style-span\" style=\"font-size: 18px; \">Control</span><br></h4><h4>oc:else</h4><p>The &lt;oc:else&gt; tag always evaluates to true, thus leaving it as the last tag within an &lt;oc:if&gt; ensures that at least one condition will be displayed.</p><h2>Plugging in new tags</h2><p>Adding a new conditional tag is implemented with the following steps:</p><p></p><ol><li>Create a class that implements ObjectCloud.Interfaces.WebServer.ITemplateConditionHandler. &nbsp;The IsConditionMet method returns true if the condition is met and thus the tag contents should be displayed.</li><li>Register the handler and tag name in the TemplateConditions.xml file. &nbsp;This file is a Spring.Net&nbsp;dependency&nbsp;injection file.</li></ol><p></p><h2 style=\"font-size: 1.25em; font-weight: bold; \">Script&nbsp;Dependency&nbsp;Resolution<br></h2><h2 style=\"font-size: 1.25em; font-weight: bold; \">CSS Dependency&nbsp;Resolution<br></h2><h2>Header/Footer Manipulation from Components<br></h2><h2>jQuery Template Support<br></h2><div>TODO: &nbsp;Recursion through oc:action tag.</div><h2>Automatic &lt;img&gt;, &lt;script&gt;, and &lt;link&gt; tag manipulation for Caching support<br></h2><p>TODO: &nbsp;A cool feature would be to pre-calculate image width and height to give pages a better perception of loading fast.</p><h2>Plugins<br></h2></div><h2>Accessing Components as a page</h2><p>By default, if the user types a component's URL into the browser's address bar, ObjectCloud will attempt to render the component inside of the default header/footer. &nbsp;In some situations, such as when integrating into a desktop application or mobile application, it may be desirable to get just the component's XML / HTML without a header or footer. &nbsp;The header/footer can be controlled by appending the HeaderFooterOverride GET parameter.</p><p>The following values are allowed for HeaderFooterOverride:</p><p></p><ul><li><b>Minimal</b>: &nbsp;ObjectCloud creates a minimialistic header/footer so, if the returned content is displayed in a web browser or web browser component, the user just sees the component and nothing else.</li><li><b>None</b>: &nbsp;ObjectCloud does not enclose the component in any header/footer. &nbsp;This can have unpredictable results when rendered as HTML because scripts and css might not be loaded; although it does allow a consuming client manipulate the results in unanticipated ways.</li><li><b>/</b>: &nbsp;Any values that start with a \"/\" indicate an file to use as the header/footer. &nbsp;This allows&nbsp;overriding&nbsp;the header/footer through the URL.</li></ul><p></p><h1>Other ObjectCloud changes</h1><h2>BrowserCache calculation<br></h2><p>Currently, ObjectCloud calculates many MD5s to append to urls as a BrowserCache argument. &nbsp;Now, the lower-level IFileHandler will have an MD5 property that the templating system can take advantage of when possible.</p><h2>Loading XmlDocuments in ITextHandlers</h2><p>ITextHandlers may expose a lazily-initialized XmlDocument property which is a pre-cached XmlDocument loaded by evaluating the contents of the text file. &nbsp;This should be automatically \"cleared\" if the text file is overwritten, and re-lazily-initialized upon re-access.</p><p></p>", "Title": "ObjectCloud Templating System"}