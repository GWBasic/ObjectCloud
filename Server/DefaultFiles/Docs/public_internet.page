{"Title":"Putting ObjectCloud on the Public Internet","Contents":"<p><a href=\"about.page\">About ObjectCloud</a></p><p>As distributed, ObjectCloud is intended to allow for an easy and painless test-drive with minimal manual configuration. There are some additional steps that need to be taken when using ObjectCloud on the public internet. These steps require modifying ObjectCloudConfig.xml.</p><h1>Use Linux</h1><p>Currently, Linux is strongly recommended for hosting ObjectCloud as a server. This is because ObjectCloud handles SIGINT, but does not support installing as a Windows Service.</p><h1>Disable Console Logging</h1><p>ObjectCloud logs a lot of information. As distributed, ObjectCloud sends all this information to the console to facilitate debugging and give a view of what's happening inside the server. (This is all the stuff that you see fly through the screen whenever you load a page.)<br/></p><p>For performance reasons, Console logging should be disabled when ObjectCloud is being hosted on the public internet or in a multi-user situation.</p><p>To disable Console logging, remove the following tag:</p><pre style=\"margin-left: 40px;\">&lt;!-- When running a real server, this line should be deleted.  Writing to the console really kills performance --&gt;<br/>&lt;LogHandlerFactory WriteToConsole=\"true\" /&gt;<br/></pre><p>You can view the log through the web at <a target=\"_blank\" title=\"\" href=\"/System/Log\">/System/Log</a>.<br/></p><p>ObjectCloud's logging system is built around <a target=\"_blank\" title=\"\" href=\"http://netcommon.sourceforge.net/\">Common.Logging</a>; working with other logging implementations is possible, but officially unsupported at this time.<br/></p><h1>Configure the Host Name</h1><p>In order for OpenID and some messaging features to work correctly, ObjectCloud needs to know its host name. When the host name isn't specified, ObjectCloud uses the computer's IP. This setting is fine for experimentation on a LAN, but will not work when ObjectCloud is exposed to the public internet.</p><p>You can get a free host name at <a target=\"_blank\" title=\"\" href=\"http://www.dyndns.com/\">http://www.dyndns.com/</a>.<br/></p><p>To set the host name, un-comment and edit the following tag: (Remove the &lt;!-- stuff)<br/></p><pre style=\"margin-left: 40px;\">&lt;!-- &lt;FileHandlerFactoryLocator\n  Hostname=\"<span style=\"background-color: rgb(255, 255, 51);\">somedomain.???</span>\"\n  CallHomeEndpoint=\"http://objectcloud.kicks-ass.net/Stats/CallHomeTracker?Method=CallHome\" /&gt; --&gt;</pre><p>Replace the somedomain.??? with the actual host name.<br/></p><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p><b>Note</b>: <i>There is a call-home option in this tag. Please don't disable it; we use these statistics to count how many ObjectCloud instances are on the internet.</i></p></blockquote><h1>Change the Port to 80 (aka, getting rid of the :1080)<br/></h1><p>Most web servers operate on Port 80. On Mac and Linux, this requires an elevated set of permissions. To keep things simple for an easy test-drive, ObjectCloud defaults to port 1080. (This is why the url ends with the funny :1080.)</p><p>To change the port number, update the following tag to state Port=\"80\"<br/></p><pre style=\"margin-left: 40px;\">&lt;WebServer<br/>  Port=\"<span style=\"background-color: rgb(255, 255, 51);\">1080</span>\"<br/>  RedirectIfRequestedHostIsDifferent=\"true\"<br/>  MinimizeJavascript=\"true\"<br/>  /&gt;<br/></pre><h1>Open and Forward Port 80<br/></h1>Port 80 must be open on the computer that hosts ObjectCloud, and forwarded from the firewall, router, or proxy. This task is outside of the scope of this document.<br/><h1>(Optional) Disabling Auto-Redirect</h1><p>By default, if an incoming request is for a host other then the one that ObjectCloud is configured for, ObjectCloud will redirect the request to its configured host. For example, if the user types the server's IP into the browser, ObjectCloud will redirect the browser to the same object; but with the configured host name. The same could happen if the server is configured with multiple host names; ObjectCloud will redirect all requests to its configured host name.</p><p>This feature can be turned off by disabling RedirectIfRequestedHostIsDifferent.</p><pre style=\"margin-left: 40px;\">&lt;WebServer<br/>  Port=\"<span style=\"background-color: rgb(255, 255, 255);\">80</span>\"<br/>  RedirectIfRequestedHostIsDifferent=\"<span style=\"background-color: rgb(255, 255, 51);\">false</span>\"<br/>  MinimizeJavascript=\"true\"<br/>  /&gt;</pre>\n<h1>(Optional) Tuning Memory Usage</h1><p>ObjectCloud attempts to hold as much content as possible in RAM. This is because continually reading the disk, especially when serving files with a lot of components, can become slow.</p><p>ObjectCloud has two tuning parameters in the WebServer tag: CacheSize and MaxKnownMemoryUse.</p><h2>CacheSize</h2><p>This tuning parameter has to do with how ObjectCloud works with .Net's or Mono's garbage collector. For values that require many reads from the database, or for things like text files and images, ObjectCloud holds references in RAM in a cache. As values, text files, and images fall out of use, they are made available for garbage collection.</p><p>Every time a value is read, an entry is placed into the cache. In order for the cache to work fast, frequently used values have multiple entries in the cache. The default size is 20,000. It is&#160;recommended&#160;to use a cache size in the thousands unless ObjectCloud slows down due to too much paging.</p><h2>MaxKnownMemoryUse</h2><p>ObjectCloud keeps track of the total size of all cached text files and images. When their total size, in bytes, exceeds MaxKnownMemoryUse, ObjectCloud will remove items from the cache in order to use less memory.</p><p>The default size is 100 megabytes. Be aware that ObjectCloud will use more memory then MaxKnownMemoryUse; this is because MaxKnownMemoryUse only manages how ObjectCloud caches text files and images; but not the rest of the program. At this time, we&#160;recommend&#160;setting this to 1/4 of the total system RAM, or 1/2 of the total RAM that you want ObjectCloud to occupy.</p><blockquote class=\"webkit-indent-blockquote\" style=\"margin: 0 0 0 40px; border: none; padding: 0px;\"><p><b>Note</b>: <i>Older versions of ObjectCloud attempted to tune RAM usage based on the garbage collector's estimate of total RAM use. It is our experience that such an approach is unreliable and slow. We now only track values that are known to be large.</i></p></blockquote>"}